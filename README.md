# MediaPipe 手势检测项目

这是一个基于 MediaPipe 的实时手势检测应用程序，采用现代化模块化架构设计，支持多种静态和动态手势识别，并具有轨迹追踪、网络通信和命令行输出功能。

## ✨ 功能特点

### 🎯 手势检测功能
- **实时手势检测**: 使用摄像头进行实时手势识别
- **多种手势支持**: 
  - 静态手势: 数字手势(一、二、三)、竖大拇指(点赞)、倒竖大拇指
  - 动态手势: 握拳到张开手势、张开到握拳手势、左右挥手手势、双指滑动手势、手掌翻转手势
- **双手支持**: 同时检测和识别两只手的手势

### 🎨 轨迹追踪功能
- **实时握拳轨迹追踪与绘制**: 可视化手部移动轨迹
- **智能轨迹平滑算法**: 减少手部抖动影响
- **抗抖动机制**: 提高手势检测稳定性
- **智能去抖与自动清除**: 自动管理轨迹生命周期
- **命令行轨迹变化输出**: 支持JSON/简单格式输出

### 🔧 技术特性
- **模块化设计**: 易于扩展新的手势检测器
- **可配置界面**: 支持显示/隐藏手部关键点、手掌中心、FPS等
- **设备集成友好**: 标准化输出格式，便于与其他设备/软件集成
- **网络通信支持**: 集成Socket客户端，支持远程设备控制
- **性能监控**: 实时FPS显示和日志记录
- **现代化包管理**: 使用UV包管理器，支持快速安装和依赖管理

## 📁 项目结构

```
cvzone-test/
├── 📄 main.py                    # 主应用程序入口
├── ⚙️ config.py                  # 全局配置文件
├── 📹 camera_manager.py          # 摄像头管理器
├── 🖼️ display.py                 # 显示管理器
├── 🤏 hand_utils.py              # 手部工具类（包含轨迹绘制和输出功能）
├── 📝 logger_config.py           # 日志配置
├── 🎯 gestures/                  # 手势检测器模块
│   ├── __init__.py
│   ├── base.py                   # 基础检测器类
│   ├── manager.py                # 手势管理器
│   ├── output.py                 # 输出管理器
│   ├── trajectory_tracker.py     # 轨迹追踪器
│   ├── static/                   # 静态手势检测器
│   │   ├── __init__.py
│   │   ├── finger_count_one.py   # 数字一手势检测器
│   │   ├── finger_count_two.py   # 数字二手势检测器  
│   │   ├── finger_count_three.py # 数字三手势检测器
│   │   └── thumbs.py             # 竖大拇指/倒竖大拇指检测器
│   └── dynamic/                  # 动态手势检测器
│       ├── __init__.py
│       ├── hand_open.py          # 握拳到张开检测器
│       ├── hand_close.py         # 张开到握拳检测器（支持轨迹追踪）
│       ├── hand_swipe.py         # 左右挥手检测器
│       ├── hand_flip.py          # 手掌翻转检测器
│       └── two_finger_swipe.py   # 双指滑动检测器
├── 🌐 connect/                   # 网络通信模块
│   ├── socket_client.py          # Socket客户端
│   └── test_socket_server.py     # Socket服务器测试
├── 🔧 cvzone/                    # CVZone 手部检测模块
│   ├── HandTrackingModule.py     # 手部追踪模块
│   └── hand_landmarker.task      # MediaPipe 模型文件
├── 📊 logs/                      # 日志目录
├── 📦 pyproject.toml             # 项目配置和依赖
├── 🔒 uv.lock                    # UV依赖锁定文件
└── 📖 README.md                  # 项目说明文档
```

## 🚀 快速开始

### 📋 系统要求

- **Python**: 3.8 - 3.11
- **摄像头**: 支持OpenCV的摄像头设备
- **操作系统**: Windows、macOS、Linux
- **内存**: 建议4GB以上
- **处理器**: 支持x86_64架构

### 🔧 安装步骤

1. **克隆项目**
   ```bash
   git clone <repository-url>
   cd cvzone-test
   ```

2. **使用UV安装依赖**（推荐）
   ```bash
   # 如果还没有安装UV
   pip install uv
   
   # 同步依赖
   uv sync
   ```

3. **或使用传统方式安装**
   ```bash
   pip install -r requirements.txt
   ```

### ▶️ 运行应用

**使用UV运行**（推荐）：
```bash
uv run python main.py
```

**或激活虚拟环境运行**：
```bash
# 激活虚拟环境
source .venv/bin/activate  # Linux/macOS
# 或
.venv\Scripts\activate     # Windows

# 运行应用
python main.py
```

## 🎮 使用说明

### 基本操作

1. **启动应用**: 运行程序后，摄像头会自动开启
2. **手势检测**: 将手放在摄像头前方，程序会自动检测并识别手势
3. **退出程序**: 按 `q` 键或关闭窗口退出

### 支持的手势

#### 🤚 静态手势
- **数字一手势**: 伸出食指，其他手指握拳
- **数字二手势**: 伸出食指和中指，其他手指握拳
- **数字三手势**: 伸出食指、中指和无名指，其他手指握拳
- **竖大拇指**: 竖起大拇指，其他手指握拳（点赞手势）
- **倒竖大拇指**: 向下竖大拇指，其他手指握拳

#### 🔄 动态手势
- **握拳到张开**: 从握拳状态快速张开手掌
- **张开到握拳**: 从张开状态握拳（支持轨迹追踪和命令行输出）
- **左右挥手**: 手掌左右快速移动
- **双指滑动**: 用食指和中指进行滑动操作
- **手掌翻转**: 手掌正反面翻转动作

### 🎯 轨迹追踪功能

- **轨迹触发**: 张开到握拳手势触发后，开始显示握拳移动轨迹
- **轨迹平滑**: 使用低通滤波算法减少手部抖动影响
- **抗抖动机制**: 容忍短暂的检测误判，提高稳定性
- **实时输出**: 轨迹变化实时输出到命令行（可配置格式）
- **自动清除**: 松开握拳后轨迹自动清除

### 🔄 冷却期机制

所有动态手势检测器都有冷却期，防止重复触发，确保检测的准确性和稳定性。

## 🎯 应用场景

### 🎮 游戏与娱乐
- **游戏控制**: 通过手势控制游戏角色移动和操作
- **VR/AR应用**: 自然的手势交互界面
- **体感游戏**: 无需手柄的游戏体验

### 🏠 智能家居
- **设备控制**: 手势控制灯光、音响、空调等设备
- **无接触操作**: 在厨房、浴室等环境中的便捷控制
- **场景切换**: 通过手势快速切换家居场景

### 🤖 机器人与自动化
- **机械臂控制**: 将轨迹数据传递给机械臂
- **移动机器人**: 手势导航和路径规划
- **工业自动化**: 无接触的设备操作

### 📊 演示与展示
- **演示控制**: 手势切换幻灯片、控制演示进度
- **数字标牌**: 交互式信息展示
- **展览展示**: 博物馆、展览馆的交互体验

### 🏥 医疗与康复
- **康复训练**: 记录手部运动数据，分析康复效果
- **医疗辅助**: 无接触的设备操作，保持卫生
- **数据采集**: 手部功能评估和监测

### 🔬 科研与教育
- **算法研究**: 手势识别算法研究和数据收集
- **教育应用**: 交互式教学工具
- **行为分析**: 人机交互模式研究

### ♿ 辅助技术
- **无障碍交互**: 为行动不便人士提供替代操作方式
- **语音替代**: 通过手势进行交流
- **自适应控制**: 根据用户能力调整交互方式

## 🏗️ 技术栈

### 🔧 核心技术
- **[MediaPipe](https://mediapipe.dev/)**: Google开源的机器学习框架，用于手部关键点检测
- **[OpenCV](https://opencv.org/)**: 计算机视觉库，用于图像处理和显示
- **[NumPy](https://numpy.org/)**: 数值计算库，用于数据处理和算法实现

## 🚨 故障排除

### 检测准确性问题
**问题**: 手势检测不准确
- **解决方案**:
  - 确保光线充足，避免强烈的背光
  - 调整 `detection_confidence` 和 `min_tracking_confidence` 参数
  - 保持手部在摄像头视野内
  - 避免复杂的背景干扰

### 网络通信问题
**问题**: Socket连接失败
- **解决方案**:
  - 检查 `SOCKET_HOST` 和 `SOCKET_PORT` 配置
  - 确认目标设备在网络中可达
  - 检查防火墙设置

### 依赖问题
**问题**: 包安装失败
- **解决方案**:
  ```bash
  # 更新UV
  pip install --upgrade uv
  
  # 清理缓存
  uv cache clean
  
  # 重新安装
  uv sync --refresh
  ```
